#!/bin/bash

# Clear the terminal for a professional look
clear
echo "===================================================="
echo "    AUTOMATED MALWARE ANALYSIS TOOLKIT             "
echo "===================================================="

# Check if a filename was provided as an argument
if [ -z "$1" ]
then
    echo "[!] Error: No file provided for analysis."
    echo "[!] Usage: ./run_lab.sh <malware_sample>"
    exit 1
fi

MALWARE_SAMPLE=$1

# 1. STATIC ANALYSIS PHASE
# Running the Python static analyzer to check hashes and IoCs without execution
echo "[STEP 1/2] Launching Static Analysis..."
python3 static_analyzer.py "$MALWARE_SAMPLE"
echo "----------------------------------------------------"

# 2. DYNAMIC ANALYSIS PHASE
# Starting the network sniffer to monitor live behavior
echo "[STEP 2/2] Starting Network Monitor (Sniffer)..."
echo "[*] Reports are saved automatically with timestamps."
echo "[*] IMPORTANT: Switch to your Victim VM and execute the sample."
echo "[*] Press CTRL+C to stop monitoring once analysis is complete."
echo "----------------------------------------------------"

# Execute the monitor with sudo privileges for raw packet access
sudo python3 monitor.py
